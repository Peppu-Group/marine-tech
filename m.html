<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MarineOps - Crew Management</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 0;
      padding: 20px;
      background-color: #f5f7fa;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    h1, h2 {
      color: #005792;
    }
    h1 {
      margin-bottom: 20px;
      border-bottom: 2px solid #00a8e8;
      padding-bottom: 10px;
    }
    .crew-section {
      margin-bottom: 30px;
    }
    .crew-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .crew-card {
      background-color: #f8f9fa;
      border-radius: 6px;
      padding: 15px;
      box-shadow: 0 1px 5px rgba(0, 0, 0, 0.08);
      border-left: 4px solid #00a8e8;
      position: relative;
    }
    .crew-card.unavailable {
      border-left-color: #dc3545;
      opacity: 0.8;
    }
    .crew-name {
      font-weight: bold;
      font-size: 1.1em;
      margin-bottom: 5px;
      color: #005792;
    }
    .crew-role {
      color: #6c757d;
      font-size: 0.9em;
      margin-bottom: 10px;
    }
    .crew-certifications, .crew-availability {
      font-size: 0.85em;
      margin: 5px 0;
    }
    .certification-tag {
      display: inline-block;
      background-color: #e6f7ff;
      color: #005792;
      border-radius: 4px;
      padding: 2px 8px;
      margin-right: 5px;
      margin-bottom: 5px;
      font-size: 0.85em;
    }
    .certification-tag.expiring {
      background-color: #fff3cd;
      color: #856404;
    }
    .certification-tag.expired {
      background-color: #f8d7da;
      color: #721c24;
    }
    .status-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 0.75em;
      padding: 3px 8px;
      border-radius: 12px;
      font-weight: bold;
    }
    .status-available {
      background-color: #d4edda;
      color: #155724;
    }
    .status-unavailable {
      background-color: #f8d7da;
      color: #721c24;
    }
    .status-onduty {
      background-color: #cce5ff;
      color: #004085;
    }
    .action-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
    }
    .btn {
      padding: 6px 12px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      font-size: 0.9em;
      transition: background-color 0.2s;
    }
    .btn-primary {
      background-color: #005792;
      color: white;
    }
    .btn-primary:hover {
      background-color: #004675;
    }
    .btn-secondary {
      background-color: #e9ecef;
      color: #495057;
    }
    .btn-secondary:hover {
      background-color: #dde2e6;
    }
    .search-filter {
      display: flex;
      margin-bottom: 20px;
      gap: 10px;
    }
    .search-filter input, .search-filter select {
      padding: 8px 12px;
      border: 1px solid #ced4da;
      border-radius: 4px;
    }
    .search-filter input {
      flex-grow: 1;
    }
    .search-filter select {
      width: 30%;
    }
    .add-crew-form {
      background-color: #f8f9fa;
      padding: 20px;
      border-radius: 6px;
      margin-top: 30px;
    }
    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 15px;
    }
    .form-group {
      flex: 1;
      min-width: 200px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #495057;
    }
    .form-group input, .form-group select, .form-group textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ced4da;
      border-radius: 4px;
    }
    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 20px;
    }
    .no-results {
      text-align: center;
      padding: 20px;
      color: #6c757d;
    }
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
  </style>
</head>
<body>
  <div id="app" class="container">
    <h1>MarineOps Crew Management</h1>
    
    <div class="crew-section">
      <div class="section-header">
        <h2>Current Crew</h2>
        <button class="btn btn-primary" @click="showAddForm = !showAddForm">
          {{ showAddForm ? 'Cancel' : '+ Add Crew Member' }}
        </button>
      </div>
      
      <div class="search-filter">
        <input type="text" placeholder="Search crew by name or role..." v-model="searchQuery">
        <select v-model="filterStatus">
          <option value="all">All Statuses</option>
          <option value="available">Available</option>
          <option value="onduty">On Duty</option>
          <option value="unavailable">Unavailable</option>
        </select>
      </div>
      
      <div class="crew-grid" v-if="filteredCrew.length > 0">
        <div v-for="member in filteredCrew" :key="member.id" class="crew-card" :class="{'unavailable': member.status === 'unavailable'}">
          <div :class="['status-badge',
            member.status === 'available' ? 'status-available' : 
            member.status === 'onduty' ? 'status-onduty' : 'status-unavailable']">
            {{ member.status.charAt(0).toUpperCase() + member.status.slice(1) }}
          </div>
          <div class="crew-name">{{ member.name }}</div>
          <div class="crew-role">{{ member.role }}</div>
          <div class="crew-certifications">
            <div v-for="cert in member.certifications" :key="cert" class="certification-tag">{{ cert }}</div>
          </div>
          <div class="crew-availability">
            <strong>Next Shift:</strong> {{ member.nextShift || 'Not Scheduled' }}
          </div>
          <div class="action-buttons">
            <button class="btn btn-secondary">View Details</button>
            <button class="btn btn-primary">Assign Shift</button>
          </div>
        </div>
      </div>
      
      <div v-else class="no-results">
        No crew members found matching your search criteria.
      </div>
      
      <div class="add-crew-form" v-if="showAddForm">
        <h2>Add New Crew Member</h2>
        <div class="form-row">
          <div class="form-group">
            <label for="crew-name">Full Name</label>
            <input type="text" id="crew-name" v-model="newCrew.name">
          </div>
          <div class="form-group">
            <label for="crew-role">Role/Position</label>
            <select id="crew-role" v-model="newCrew.role">
              <option value="Captain">Captain</option>
              <option value="First Officer">First Officer</option>
              <option value="Engineer">Engineer</option>
              <option value="Deckhand">Deckhand</option>
              <option value="Mechanic">Mechanic</option>
              <option value="Cook">Cook</option>
            </select>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="crew-photo">Profile Photo</label>
            <div class="file-upload">
              <label class="file-upload-label">
                <input type="file" id="crew-photo" accept="image/*" @change="handleFileUpload">
                Choose File
              </label>
              <span class="file-name">{{ newCrew.photoName || 'No file chosen' }}</span>
            </div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="crew-status">Status</label>
            <select id="crew-status" v-model="newCrew.status">
              <option value="available">Available</option>
              <option value="onduty">On Duty</option>
              <option value="unavailable">Unavailable</option>
            </select>
          </div>
          <div class="form-group">
            <label for="crew-next-shift">Next Scheduled Shift</label>
            <input type="text" id="crew-next-shift" v-model="newCrew.nextShift" placeholder="e.g., May 18, 08:00-16:00">
          </div>
        </div>
        
        <div class="certification-section">
          <h3>Certifications</h3>
          <div class="certification-grid">
            <div v-for="cert in availableCertifications" :key="cert.id" class="certification-item">
              <input type="checkbox" :id="'cert-' + cert.id" :value="cert.id" v-model="newCrew.selectedCertifications">
              <label :for="'cert-' + cert.id">{{ cert.name }}</label>
            </div>
          </div>
          
          <div v-if="newCrew.selectedCertifications.length > 0">
            <h4>Certification Details</h4>
            <div class="certification-expiry-row" v-for="certId in newCrew.selectedCertifications" :key="certId">
              <div class="certification-details">
                <div class="certification-name">{{ getCertificationName(certId) }}</div>
                <div class="form-group">
                  <label>Expiry Date</label>
                  <input type="date" v-model="newCrew.certificationExpiry[certId]">
                </div>
              </div>
              <div class="certification-image">
                <label>Certification Image</label>
                <div class="file-upload">
                  <label class="file-upload-label">
                    <input type="file" accept="image/*" @change="event => handleCertFileUpload(event, certId)">
                    Upload Document
                  </label>
                  <span class="file-name">{{ getCertificationImageName(certId) || 'No file chosen' }}</span>
                </div>
                <div class="thumbnail-preview" v-if="newCrew.certificationImages[certId]">
                  <img :src="newCrew.certificationImages[certId]" alt="Certificate preview">
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="crew-notes">Notes</label>
            <textarea id="crew-notes" rows="3" v-model="newCrew.notes"></textarea>
          </div>
        </div>
        
        <div class="form-actions">
          <button class="btn btn-secondary" @click="resetForm">Clear Form</button>
          <button class="btn btn-primary" @click="addCrewMember">Add Crew Member</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const { createApp, ref, computed } = Vue;
    
    createApp({
      setup() {
        const crewMembers = ref([
          {
            id: 1,
            name: "John Smith",
            role: "Captain",
            status: "onduty",
            certifications: [
              { name: "Navigation", expiryDate: "2025-12-15", documentImage: "/api/placeholder/80/60" },
              { name: "Safety", expiryDate: "2026-05-22", documentImage: "/api/placeholder/80/60" },
              { name: "Command", expiryDate: "2026-02-10", documentImage: "/api/placeholder/80/60" }
            ],
            nextShift: "Current - May 16, 08:00-20:00",
            photo: "/api/placeholder/50/50"
          },
          {
            id: 2,
            name: "Emily Rodriguez",
            role: "First Officer",
            status: "onduty",
            certifications: [
              { name: "Navigation", expiryDate: "2025-10-05", documentImage: "/api/placeholder/80/60" },
              { name: "Communications", expiryDate: "2025-08-30", documentImage: "/api/placeholder/80/60" },
            ],
            nextShift: "Current - May 16, 08:00-20:00"
          },
          {
            id: 3,
            name: "David Chen",
            role: "Engineer",
            status: "available",
            certifications: [
              { name: "Mechanical", expiryDate: "2025-03-22", documentImage: "/api/placeholder/80/60" },
              { name: "Electrical", expiryDate: "2025-11-15", documentImage: "/api/placeholder/80/60" }
            ],
            nextShift: "May 17, 20:00-08:00",
            photo: "/api/placeholder/50/50"
          },
          {
            id: 4,
            name: "Sarah Johnson",
            role: "Deckhand",
            status: "unavailable",
            certifications: [
              { name: "First Aid", expiryDate: "2025-05-30", documentImage: "/api/placeholder/80/60" },
              { name: "Safety", expiryDate: "2024-12-10", documentImage: "/api/placeholder/80/60" }
            ],
            nextShift: "May 20, 08:00-20:00"
          },
          {
            id: 5,
            name: "Michael Lee",
            role: "Mechanic",
            status: "available",
            certifications: [
              { name: "Mechanical", expiryDate: "2025-07-12", documentImage: "/api/placeholder/80/60" },
              { name: "Welding", expiryDate: "2024-06-01", documentImage: "/api/placeholder/80/60" }
            ],
            nextShift: "May 18, 08:00-20:00"
          },
          {
            id: 6,
            name: "Olivia Williams",
            role: "Cook",
            status: "onduty",
            certifications: [
              { name: "Food Safety", expiryDate: "2025-09-15", documentImage: "/api/placeholder/80/60" },
              { name: "First Aid", expiryDate: "2025-04-30", documentImage: "/api/placeholder/80/60" }
            ],
            nextShift: "Current - May 16, 04:00-16:00",
            photo: "/api/placeholder/50/50"
          }
        ]);
        
        const searchQuery = ref('');
        const filterStatus = ref('all');
        const showAddForm = ref(false);
        const newCrew = ref({
          name: '',
          role: 'Deckhand',
          status: 'available',
          nextShift: '',
          notes: '',
          photo: null,
          photoName: '',
          selectedCertifications: [],
          certificationExpiry: {},
          certificationImages: {},
          certificationImageNames: {}
        });
        
        const availableCertifications = ref([
          { id: 1, name: "Navigation" },
          { id: 2, name: "Safety" },
          { id: 3, name: "Command" },
          { id: 4, name: "First Aid" },
          { id: 5, name: "CPR" },
          { id: 6, name: "Mechanical" },
          { id: 7, name: "Electrical" },
          { id: 8, name: "Welding" },
          { id: 9, name: "Communications" },
          { id: 10, name: "Fire Fighting" },
          { id: 11, name: "Survival at Sea" },
          { id: 12, name: "Food Safety" },
          { id: 13, name: "Hazardous Materials" }
        ]);
        
        const getCertificationName = (id) => {
          const cert = availableCertifications.value.find(c => c.id === id);
          return cert ? cert.name : '';
        };
        
        const getCertificationImageName = (certId) => {
          return newCrew.value.certificationImageNames[certId] || '';
        };
        
        const handleCertFileUpload = (event, certId) => {
          const file = event.target.files[0];
          if (file) {
            // Store the file name
            newCrew.value.certificationImageNames[certId] = file.name;
            // In a real implementation, you would upload the file to server
            // For this example, we'll use a placeholder
            newCrew.value.certificationImages[certId] = "/api/placeholder/80/60";
          }
        };
        
        const viewCertificateImage = (cert) => {
          // In a real implementation, this would open a modal or lightbox to view the image
          alert(`Viewing certificate document for: ${cert.name}`);
          // Alternative implementation could be to open a modal with the image
        };
        
        const isExpiringSoon = (dateStr) => {
          const expiryDate = new Date(dateStr);
          const today = new Date();
          const threeMonthsFromNow = new Date();
          threeMonthsFromNow.setMonth(threeMonthsFromNow.getMonth() + 3);
          
          return expiryDate > today && expiryDate <= threeMonthsFromNow;
        };
        
        const isExpired = (dateStr) => {
          const expiryDate = new Date(dateStr);
          const today = new Date();
          
          return expiryDate <= today;
        };
        
        const formatDate = (dateStr) => {
          const date = new Date(dateStr);
          return date.toLocaleDateString('en-US', { 
            year: 'numeric', 
            month: 'short', 
            day: 'numeric' 
          });
        };
        
        const handleFileUpload = (event) => {
          const file = event.target.files[0];
          if (file) {
            newCrew.value.photoName = file.name;
            // In a real implementation, you would upload the file
            // For this example, we'll just set a placeholder
            newCrew.value.photo = "/api/placeholder/50/50";
          }
        };
        
        const filteredCrew = computed(() => {
          return crewMembers.value.filter(member => {
            // Filter by search query
            const matchesSearch = member.name.toLowerCase().includes(searchQuery.value.toLowerCase()) || 
                                member.role.toLowerCase().includes(searchQuery.value.toLowerCase());
            
            // Filter by status
            const matchesStatus = filterStatus.value === 'all' || member.status === filterStatus.value;
            
            return matchesSearch && matchesStatus;
          });
        });
        
        const resetForm = () => {
          newCrew.value = {
            name: '',
            role: 'Deckhand',
            status: 'available',
            nextShift: '',
            notes: '',
            photo: null,
            photoName: '',
            selectedCertifications: [],
            certificationExpiry: {},
            certificationImages: {},
            certificationImageNames: {}
          };
        };
        
        const addCrewMember = () => {
          const certifications = newCrew.value.selectedCertifications.map(certId => {
            return {
              name: getCertificationName(certId),
              expiryDate: newCrew.value.certificationExpiry[certId] || null,
              documentImage: newCrew.value.certificationImages[certId] || null
            };
          });
          
          const newMember = {
            id: crewMembers.value.length + 1,
            name: newCrew.value.name,
            role: newCrew.value.role,
            status: newCrew.value.status,
            certifications: certifications,
            nextShift: newCrew.value.nextShift,
            notes: newCrew.value.notes,
            photo: newCrew.value.photo
          };
          
          crewMembers.value.push(newMember);
          resetForm();
          showAddForm.value = false;
        };
        
        return {
          crewMembers,
          filteredCrew,
          searchQuery,
          filterStatus,
          showAddForm,
          newCrew,
          resetForm,
          addCrewMember,
          handleFileUpload,
          handleCertFileUpload,
          availableCertifications,
          getCertificationName,
          getCertificationImageName,
          isExpiringSoon,
          isExpired,
          formatDate,
          viewCertificateImage
        };
      }
    }).mount('#app');
  </script>
</body>
</html>